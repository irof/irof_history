package com.irof.adapter;import java.net.URL;import twitter4j.User;import android.graphics.Bitmap;import android.graphics.BitmapFactory;import android.os.AsyncTask;import android.widget.ImageView;import com.irof.sns.ImageCache;import com.irof.sns.twitter_main;public class TwIconDownloadTask extends AsyncTask<String, Void, Bitmap> {	private String		screen_name;	private ImageView	view;	public TwIconDownloadTask(ImageView view_) {		view = view_;	}	// バックグラウンドで実行する処理	@Override	protected Bitmap doInBackground(String... twId) {		screen_name = twId[0];		if (ImageCache.get(screen_name) != null) return null;// 既に取得済み		if (twitter_main.m_twitter == null) return null;		Bitmap m_bmp_panel = null;		try {			User user = twitter_main.m_twitter.showUser(screen_name);			URL imageURL = new URL(user.getMiniProfileImageURL());			// URL imageURL = user.getProfileImageURL();			m_bmp_panel = BitmapFactory.decodeStream(imageURL.openConnection()					.getInputStream());		}		catch (Exception e) {		}		return m_bmp_panel;	}	// メインスレッドで実行する処理	@Override	protected void onPostExecute(Bitmap m_bmp_panel) {		if (screen_name == null || "".equals(screen_name)				|| m_bmp_panel == null) return;		/*		 * int size = m_bmp_panel.getWidth() * m_bmp_panel.getHeight();		 * ByteArrayOutputStream out = new ByteArrayOutputStream(size);		 * m_bmp_panel.compress(Bitmap.CompressFormat.JPEG, 100, out); byte[]		 * bytSig = out.toByteArray();		 */		ImageCache.put(screen_name, m_bmp_panel);		if (view != null) view.setImageBitmap(m_bmp_panel);		// ImageCache.saveIconList();	}}